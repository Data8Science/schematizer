<!DOCTYPE html>
<html lang="en" ng-app="docToolApp">
    <head>
        <title>Documentation Tool</title>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>

        <script src="/static/js/app.js"></script>
        <link rel="stylesheet" type="text/css" href="/static/css/schematizer.css"/>
    </head>

    <body ng-controller="docToolCtrl">

        <!-- Navbar -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse">
                        <span class="sr-only">Toggle navigation</span>
                    </button>
                    <span class="navbar-brand"><a href="./">Data Warehouse Documentation Tool</a></span>
                </div>
            </div>
        </nav>

        <div class="container">

            <!-- Search box -->
            <div class="panel panel-primary">
                <div class="panel-heading">Search</div>
                <div class="panel-body">
                    <form ng-submit="search()" class="form-inline" role="form">
                        <div class="form-group col-md-8">
                            <label class="control-label">Search for:</label>
                            <select class="form-control" id="searchType" ng-model="control">
                                <option>schema</option>
                                <option>topic</option>
                                <option>source</option>
                            </select>
                            <input type="text" class="form-control" ng-model="text"/>
                            <input type="submit" id="submit" value="Submit"/>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Returned schema -->
            <div ng-show="show==='schema'">
                <table class="table table-bordered btn-link">
                    <tr>
                        <th ng-click="searchTopic(data.topic.name)">Go to Topic: {{data.topic.name}}</th>
                    </tr>
                </table>
                <table class="table table-striped table-bordered">
                    <tr>
                        <th>Field</th>
                        <th>Value</th>
                    <tr ng-repeat="(key, field) in data">
                        <td>{{key}}</td>
                        <td>{{field}}</td>
                    </tr>
                </table>
            </div>

            <!-- Error on requesting schema-->
            <div class="row" ng-show="show==='schemaError'">
                <div class="col-lg-12">
                    <div class="alert alert-danger" role="alert">No schemas found. Make sure to search by schema ID numbers.</div>
                </div>
            </div>

            <!-- Returned topic -->
            <div ng-show="show==='topic'">
                <table class="table table-striped table-bordered">
                    <tr>
                        <th>Schema ID</th>
                        <th>Status</th>
                        <th>Created At</th>
                        <th>Updated At</th>
                    </tr>
                    <tr class="btn-link" ng-repeat="schema in data" ng-click="searchSchema(schema.schema_id)">
                        <td>{{schema.schema_id}}</td>
                        <td>{{schema.status}}</td>
                        <td>{{schema.created_at}}</td>
                        <td>{{schema.updated_at}}</td>
                    </tr>
                </table>
            </div>

            <!-- Error on requesting topic-->
            <div ng-show="show==='topicError'">
                <div class="col-lg-12">
                    <div class="alert alert-danger" role="alert">No topics found.</div>
                </div>
            </div>

            <!-- Returned list of sources-->
            <div ng-show="show==='sources'">
                <table class="table table-striped table-bordered">
                    <tr>
                        <th>Namespace</th>
                        <th>Source</th>
                        <th>Source Owner Email</th>
                        <th>Created At</th>
                        <th>Updated At</th>
                    </tr>
                    <tr class="btn-link" ng-repeat="source in data" ng-click="getTopicsFromSource(source.source_id)">
                        <td>{{source.namespace}}</td>
                        <td>{{source.source}}</td>
                        <td>{{source.source_owner_email}}</td>
                        <td>{{source.created_at}}</td>
                        <td>{{source.updated_at}}</td>
                    </tr>
                </table>
            </div>

            <!-- Returned list of topics-->
            <div ng-show="show==='source'">
                <table class="table table-striped table-bordered">
                    <tr>
                        <th>Source Name</th>
                        <th>Created At</th>
                        <th>Updated At</th>
                    </tr>
                    <tr class = "btn-link" ng-repeat="topic in data" ng-click="searchTopic(topic.name)">
                        <td>{{topic.name}}</td>
                        <td>{{topic.created_at}}</td>
                        <td>{{topic.updated_at}}</td>
                    </tr>
                </table>

        </div>
    </body>
</html>

"""
Database, connection, cursor, etc utility methods.
"""

def cursor_result_to_dict(rows, cursor_description):
    """
    Convert the result of a SELECT (or such) into a list of dictionaries ala

    [{'row1': val, 'row2': val ...}, ...]
    """
    keys = []
    for row in cursor_description:
        keys.append(row[0])
    result = []
    for row in rows:
        result_dict = {}
        for key, value in zip(keys, row):
            result_dict[key] = value
        result.append(result_dict)
    return result


def fetchall_rows_to_dict(cursor):
    """ Because calling fetchall() here is a great idea"""
    rows = cursor.fetchall()
    return cursor_result_to_dict(rows, cursor.description)

# -*- coding: utf-8 -*-
"""Utils for getting sqla columns and properties from them.
Separate from utils for EMR import reasons.
"""
def get_column(column):
    """Get the underlying column from a property that might wrap the real property like an InstrumentedAttribute"""
    if not hasattr(column, 'type'):
        # An InstrumentedAttribute propert has a 'property' attrbibute that is the actual ColumnProperty
        if hasattr(column, 'property'):
            column = column.property

        # This is hairy, but it seems to be the best way to trick an attribute into giving up the underlying type.
        column = column.columns[0]

    return column

def get_column_type(column):
    """Extract the column type from a column or property"""
    return get_column(column).type

def get_column_name(column):
    """Extract the column type from a column or property"""
    return get_column(column).name

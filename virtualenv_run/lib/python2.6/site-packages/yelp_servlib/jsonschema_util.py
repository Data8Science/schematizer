# -*- coding: utf-8 -*-
import json

from jsonschema.validators import validator_for
from jsonschema import FormatChecker
from pkg_resources import resource_filename



__all__ = ['get_validator']

_validators = {}

def get_validator(log_type, version=None):
    version = version or '1'
    filename = '%s-%s' % (log_type, version)
    if filename in _validators:
        return _validators[filename]
    with open(resource_filename(__name__, 'logschemas/%s.json' % filename)) as f:
        schema = json.load(f)
    validator = validator_for(schema)(schema, format_checker = FormatChecker())
    _validators[filename] = validator
    return validator

"""
Utilities for controlling Python's reference cycle garbage collector.
"""

import gc

# the collector has three generations
GC_LEVELS = (0, 1, 2)

def perform_minimal_gc():
    """Reimplements the automatic GC behavior of collecting as few generations as possible.

    Returns: maximum generation that was collected, None if none were.
    """
    max_collection_performed = None
    threshold = gc.get_threshold()
    for level in GC_LEVELS:
        if gc.get_count()[level] > threshold[level]:
            gc.collect(level)
            max_collection_performed = level
        else:
            break
    return max_collection_performed
